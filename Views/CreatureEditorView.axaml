<UserControl x:Class="MasterplanXP.Views.CreatureEditorView"
             xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="900"
             
             xmlns:vm="using:MasterplanXP.ViewModels"
             x:DataType="vm:CreatureEditorViewModel"
             x:CompileBindings="True"
             xmlns:conv="using:MasterplanXP.Converters">

    <Design.DataContext>
        <vm:CreatureEditorViewModel/>
    </Design.DataContext>
    
    <UserControl.Styles>
        <Style Selector="TextBox">
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="2"/>
            <Setter Property="Margin" Value="0, 0, 0, 1"/>
        </Style>
    </UserControl.Styles>

    <UserControl.Resources>
        <conv:MonsterColorConverter x:Key="MonsterColorConverter" />
    </UserControl.Resources>
    
    <Border Padding="0"> 
    
        <Grid ColumnDefinitions="*, Auto, 130"> 
            
            <ScrollViewer Grid.Column="1"
                          VerticalScrollBarVisibility="Visible" 
                          MinWidth="300" MaxWidth="500" 
                          HorizontalAlignment="Left" VerticalAlignment="Top">
            
                <Border Background="White" CornerRadius="5" BoxShadow="0 0 10 0 #30000000" Padding="5">
                
                    <StackPanel Spacing="0" Margin="0" HorizontalAlignment="Stretch">
                        
                        <Grid ColumnDefinitions="*, Auto" Margin="0, 0, 0, 0">
                            <TextBlock Grid.Column="0" Text="{Binding CurrentCreature.Name}" 
                                       FontSize="32" FontWeight="ExtraBold" Foreground="#A00000"
                                       VerticalAlignment="Bottom"/>
                            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Bottom" Margin="0, 0, 0, 4">
                                <TextBlock Text="Level " FontSize="24" FontWeight="SemiBold" Foreground="#A00000"/>
                                <TextBlock Text="{Binding CurrentCreature.Level}" FontSize="24" FontWeight="Bold" Foreground="#A00000"/>
                                <TextBlock Text=" "/>
                                <TextBlock Text="{Binding CurrentCreature.Role}" FontSize="24" FontWeight="Bold" Foreground="#A00000"/>
                            </StackPanel>
                        </Grid>

                        <Grid ColumnDefinitions="*, Auto" Margin="0, 0, 0, 5">
                            <TextBlock Grid.Column="0" Text="{Binding CurrentCreature.SizeAndType}" 
                                       FontStyle="Italic" Margin="0, 0, 10, 0" Foreground="#555"/>
                            <TextBlock Grid.Column="1" Text="{Binding CurrentCreature.ExperiencePoints, StringFormat='XP {0}'}" 
                                       FontWeight="SemiBold" Foreground="#888"/>
                        </Grid>
                        
                        <Separator Height="2" Background="#A00000" Margin="0, 2, 0, 5" />

                        <Grid ColumnDefinitions="Auto, 55, Auto, 55, Auto, 55, *, Auto" RowDefinitions="Auto, Auto" HorizontalAlignment="Stretch" ColumnSpacing="10" RowSpacing="5">
                            
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="HP" FontWeight="Bold" Foreground="#A00000" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="0" Text="{Binding CurrentCreature.MaxHitPoints}" HorizontalAlignment="Left" VerticalAlignment="Center" Background="{Binding CurrentCreature, Converter={StaticResource MonsterColorConverter}, ConverterParameter=NeutralBackground}"/>
                            
                            <TextBlock Grid.Column="2" Grid.Row="0" Text="AC" FontWeight="Bold" Foreground="#A00000" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="3" Grid.Row="0" Text="{Binding CurrentCreature.ArmorClass}" HorizontalAlignment="Left" VerticalAlignment="Center" Background="{Binding CurrentCreature, Converter={StaticResource MonsterColorConverter}, ConverterParameter=NeutralBackground}"/>

                            <TextBlock Grid.Column="4" Grid.Row="0" Text="Speed" FontWeight="Bold" Foreground="#A00000" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="5" Grid.Row="0" Text="{Binding CurrentCreature.Speed}" HorizontalAlignment="Left" VerticalAlignment="Center" Background="{Binding CurrentCreature, Converter={StaticResource MonsterColorConverter}, ConverterParameter=NeutralBackground}"/>
                            
                            <TextBlock Grid.Column="0" Grid.Row="1" Text="Fort" FontWeight="Bold" Foreground="#005500" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Grid.Row="1" Text="{Binding CurrentCreature.Fortitude}" HorizontalAlignment="Left" VerticalAlignment="Center" Background="{Binding CurrentCreature, Converter={StaticResource MonsterColorConverter}, ConverterParameter=NeutralBackground}"/>
                            
                            <TextBlock Grid.Column="2" Grid.Row="1" Text="Ref" FontWeight="Bold" Foreground="#005500" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="3" Grid.Row="1" Text="{Binding CurrentCreature.Reflex}" HorizontalAlignment="Left" VerticalAlignment="Center" Background="{Binding CurrentCreature, Converter={StaticResource MonsterColorConverter}, ConverterParameter=NeutralBackground}"/>

                            <TextBlock Grid.Column="4" Grid.Row="1" Text="Will" FontWeight="Bold" Foreground="#005500" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="5" Grid.Row="1" Text="{Binding CurrentCreature.Will}" HorizontalAlignment="Left" VerticalAlignment="Center" Background="{Binding CurrentCreature, Converter={StaticResource MonsterColorConverter}, ConverterParameter=NeutralBackground}"/>
                            
                        </Grid>
             
                        <Separator Height="1" Background="#CCCCCC" Margin="0, 5, 0, 5"/>

                        <StackPanel Spacing="5">
                            <TextBlock Text="Traits" FontSize="18" FontWeight="Bold" Foreground="#005500" Margin="0, 0, 0, 5"/>
                            <TextBox Text="{Binding CurrentCreature.Traits}" TextWrapping="Wrap" MinHeight="40" 
                                     AcceptsReturn="True" Background="{Binding CurrentCreature, Converter={StaticResource MonsterColorConverter}, ConverterParameter=NeutralBackground}"/>
                        </StackPanel>
                        
                        <Separator Height="1" Background="#CCCCCC" Margin="0, 15, 0, 15"/>

                        <TextBlock Text="Standard Actions" FontSize="18" FontWeight="Bold" Foreground="#005500" Margin="0, 0, 0, 5"/>
                        
                        <ItemsControl ItemsSource="{Binding CurrentCreature.Actions}" HorizontalAlignment="Stretch">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Margin="0, 0, 0, 1">
                                 
                                        <Border BorderThickness="1" BorderBrush="#333333" CornerRadius="0">
                                            
                                            <StackPanel Orientation="Vertical">
                                                
                                                <Border Background="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=HeaderBackground}" 
                                                        Padding="5, 3">
                                                    <Grid ColumnDefinitions="Auto, 30, *">
                                                        
                                                        <TextBlock Grid.Column="0" Text="•" FontWeight="Bold" Margin="0, 0, 5, 0" 
                                                                   Foreground="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=HeaderForeground}" 
                                                                   VerticalAlignment="Center"/>
                                                        
                                                        <Image Grid.Column="1"
                                                               Width="18" Height="18" 
                                                               Margin="0, 0, 5, 0" VerticalAlignment="Center"
                                                               Source="{Binding IconPath}" />
                                                        
                                                        <TextBox Grid.Column="2" Text="{Binding NameAndFrequencyDisplay}"
                                                                 FontWeight="Bold" 
                                                                 TextWrapping="Wrap"  
                                                                 Background="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=HeaderBackground}"
                                                                 Foreground="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=HeaderForeground}"
                                                                 HorizontalAlignment="Stretch" 
                                                                 AcceptsReturn="True"/>
                                                    </Grid>
                                                </Border>
                                                
                                                <Border Background="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=BodyBackground}" 
                                                        Padding="5, 3">
                                                    
                                                    <TextBox Text="{Binding HitAndDamageDisplay}"
                                                             TextWrapping="Wrap"  
                                                             Background="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=BodyBackground}"
                                                             Foreground="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=BodyForeground}"
                                                             HorizontalAlignment="Stretch" 
                                                             AcceptsReturn="True"/>
                                                </Border>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <TextBlock Text="Triggered Actions" FontSize="18" 
                                   FontWeight="Bold" Foreground="#A00000" Margin="0, 10, 0, 5"/>
                        
                        <ItemsControl ItemsSource="{Binding CurrentCreature.TriggeredActions}" HorizontalAlignment="Stretch">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Margin="0, 0, 0, 10">
                                        
                                        <Border BorderThickness="1" BorderBrush="#333333" CornerRadius="0">
                                            
                                            <StackPanel Orientation="Vertical">
                                                
                                                <Border Background="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=HeaderBackground}" 
                                                        Padding="5, 3">
                                                    <Grid ColumnDefinitions="Auto, 30, *">
                                                        
                                                        <TextBlock Grid.Column="0" Text="•" FontWeight="Bold" Margin="0, 0, 5, 0" 
                                                                   Foreground="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=HeaderForeground}" 
                                                                   VerticalAlignment="Center"/>
                                                        
                                                        <Image Grid.Column="1"
                                                               Width="18" Height="18" 
                                                               Margin="0, 0, 5, 0" VerticalAlignment="Center"
                                                               Source="{Binding IconPath}" />
                                                        
                                                        <TextBox Grid.Column="2" Text="{Binding NameAndFrequencyDisplay}"
                                                                 FontWeight="Bold" 
                                                                 TextWrapping="Wrap"  
                                                                 Background="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=HeaderBackground}"
                                                                 Foreground="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=HeaderForeground}"
                                                                 HorizontalAlignment="Stretch" 
                                                                 AcceptsReturn="True"/>
                                                    </Grid>
                                                </Border>
                                                
                                                <Border Background="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=BodyBackground}" 
                                                        Padding="5, 3">
                                                    
                                                    <TextBox Text="{Binding HitAndDamageDisplay}"
                                                             TextWrapping="Wrap"  
                                                             Background="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=BodyBackground}"
                                                             Foreground="{Binding ., Converter={StaticResource MonsterColorConverter}, ConverterParameter=BodyForeground}"
                                                             HorizontalAlignment="Stretch" 
                                                             AcceptsReturn="True"/>
                                                </Border>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        
                        <Separator Height="1" Background="#CCCCCC" Margin="0, 15, 0, 15"/>
                        <StackPanel Spacing="5">
                            <TextBlock Text="Stats Summary" FontSize="18" FontWeight="Bold" Foreground="#005500" Margin="0, 0, 0, 5"/>
                            <TextBox Text="{Binding StatsSummary}" 
                                     TextWrapping="Wrap"
                                     MinHeight="80" 
                                     AcceptsReturn="True" 
                                     Background="{Binding CurrentCreature, Converter={StaticResource MonsterColorConverter}, ConverterParameter=NeutralBackground}"
                                     FontFamily="Consolas, monospace"/>
                        </StackPanel>
                        
                        <Separator Height="1" Background="#CCCCCC" Margin="0, 15, 0, 15"/>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left"> 
                            <TextBlock Text="Source: " FontWeight="SemiBold" Foreground="#555"/>
                            <TextBox Text="{Binding CurrentCreature.Sourcebook}" Width="300" Background="{Binding CurrentCreature, Converter={StaticResource MonsterColorConverter}, ConverterParameter=NeutralBackground}"/>
                        </StackPanel>
                    
                    </StackPanel>
                </Border>
            </ScrollViewer>

            <Border Grid.Column="2"
                    BorderThickness="1" BorderBrush="#A00000" 
                    CornerRadius="3" Background="#FFF5F5"
                    HorizontalAlignment="Left" VerticalAlignment="Top" 
                    Margin="10, 0, 0, 0" Width="120"
                    Padding="5">
               
                <StackPanel Orientation="Vertical" 
                            Spacing="2" HorizontalAlignment="Right">
                    
                    <Button Margin="35,0,0,0" Content="+" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Command="{Binding LevelUpCommand}" 
                            Width="20" Height="30" Padding="0" Classes="LevelButton" />
                    
                    <Button Margin="35,0,0,0" Content="-"  HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Command="{Binding LevelDownCommand}" 
                            Width="20" Height="30" Padding="0" Classes="LevelButton" />
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                        <TextBlock Text="Lvl" HorizontalAlignment="Center" FontSize="10" FontWeight="SemiBold" Foreground="#A00000"/>
                        <TextBlock Text="{Binding CurrentCreature.Level}" HorizontalAlignment="Center" 
                                   FontWeight="Bold" FontSize="16" Foreground="#333" />
                    </StackPanel>
                    

                    
                    <Separator Height="5" Background="#A00000" Margin="0, 5, 0, 5" Width="5" HorizontalAlignment="Center"/>

                    <Button Content="+ Add New Action"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Command="{Binding AddActionCommand}"
                            Background="#A00000"
                            Foreground="White"
                            FontSize="12"
                            HorizontalAlignment="Right"
                            Margin="60, 20, -70, 160"
                            Padding="5, 5" 
                            RenderTransformOrigin="0.5, 0.5"
                            RenderTransform="rotate(90deg)" />
               
                </StackPanel>
            </Border>

        </Grid>
    </Border>
</UserControl>